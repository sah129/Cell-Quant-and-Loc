
```{r setup, include=FALSE}
source('src/functions.R')
source('src/Main.R')
```


```{r}
res <- pipeline_git1_interactive("Datasets/Dummy 1B", testing=FALSE, gui=FALSE, progress=NULL)
```
```{r}
rb <- res_before[[1]]
ra <- res_after[[1]]
```

```{r}
table(rb$vacuoles)
```

```{r}
table(ra$vacuoles)
```




```{r}
rb$df
```

```{r}
vacs_tr <- r$df[ (r$df$CellID %in% tr), "vacuoles" ]
vacs_tr
```


```{r}
tr <- c("1", "8")
```

```{r}
table(r$vacuoles)
```
```{r}
v <- rmObjects(r$vacuoles, vacs_tr, reenumerate = FALSE)
table(v)
```
```{r}
display(r$vacuoles == 17)
```


```{r}
get_display_img(df = r$df,
                membranes = r$membranes, 
                col_membranes = 'white', 
                vacuoles = v, 
                col_vacuoles ='yellow', 
                removed = r$removed,
                closed_vacuoles = TRUE, 
                img = r$channels$gfp, 
                showRemoved = FALSE, 
                showMemLabels = TRUE, 
                showVacLabels = TRUE)
```










```{r}
c <-channels$cmac
c<-channel(c, "asgreen")
display(c)
```


```{r}
fill_df <- function(res, df, category)
{
  for(i in 1:length(res))
  {
    
    df_row <- data.frame(t(res[[i]]$df[category]), row.names=NULL)
    colnames(df_row) <-  t(res[[i]]$df["CellID"])
    
    
    df_row <- cbind(Image = res[[i]]$filename[[1]], df_row)
    df <- merge(df, df_row, all.x = TRUE, all.y= TRUE)
  }
  return(df)
}
```
















##############################################################3



```{r}
get_image_names <- function(res)
{
  image_names = vector(mode = "list",length = length(res))
  for(i in 1:length(res))
  {
    image_names[i] <- res[[i]]$filename
  }
  return(image_names)
}
```




```{r}
get_max_cells <- function(res)
{
  max = -1
  for(i in 1:length(res))
  {
    if( max < nrow(res[[i]]$df["cell_mpi"]))
      max = nrow(res[[i]]$df["cell_mpi"])
  }
  return(max)
}

```


```{r}
max_cells <- get_max_cells(res)

```

```{r}
create_dummy_row <- function(row_text, m)
{
  df <- data.frame(Image = row_text)
  ids <- vector("list", m)
  for(j in 1:m)
  {
   x <- data.frame(NA)
    names(x) <- j
    ids[[j]]<- x
  }
  df <- cbind(df, ids)
  df
}
```


```{r}
create_dummy_row("hey",5)
```

